import{s as e,H as a,v as t,r as n,a as s,bi as o,bY as i,k as r,N as l}from"./index.f3f4d7ae.js";import{E as c}from"./el-message-box.b4ef4684.js";import"./el-button.bc0e1fcf.js";import"./el-input.5ea972b7.js";import"./el-overlay.6d6b237a.js";const{t:g}=r(),u=r=>{const u=e({pageSize:10,currentPage:1,total:10,tableList:[],params:{},loading:!0,currentRow:null}),p=a((()=>({...u.params,pageSize:u.pageSize,pageIndex:u.currentPage})));t((()=>u.currentPage),(()=>{P.getList()})),t((()=>u.pageSize),(()=>{1===u.currentPage||(u.currentPage=1),P.getList()}));const d=n(),m=n(),v=async()=>{await l();const e=s(d);return e},f=async e=>{if(await((null==r?void 0:r.delListApi)&&(null==r?void 0:r.delListApi(e)))){i.success(g("common.delSuccess"));const a=(u.total%u.pageSize===e.length||1===u.pageSize)&&u.currentPage>1?u.currentPage-1:u.currentPage;u.currentPage=a,P.getList()}},P={getList:async()=>{var e;u.loading=!0;const a=await(null==r?void 0:r.getListApi(s(p)).finally((()=>{u.loading=!1})));a&&(u.tableList=o(a.data||{},null==r?void 0:r.response.list),u.total=o(a.data||{},null==(e=null==r?void 0:r.response)?void 0:e.total)||0)},setProps:async(e={})=>{const a=await v();null==a||a.setProps(e)},setColumn:async e=>{const a=await v();null==a||a.setColumn(e)},getSelections:async()=>{const e=await v();return(null==e?void 0:e.selections)||[]},setSearchParams:e=>{u.currentPage=1,u.params=Object.assign(u.params,{pageSize:u.pageSize,pageIndex:u.currentPage,...e}),P.getList()},delList:async(e,a,t=!0)=>{const n=await v();if(a){if(!(null==n?void 0:n.selections.length))return void i.warning(g("common.delNoData"))}else if(!u.currentRow)return void i.warning(g("common.delNoData"));t?c.confirm(g("common.delMessage"),g("common.delWarning"),{confirmButtonText:g("common.delOk"),cancelButtonText:g("common.delCancel"),type:"warning"}).then((async()=>{await f(e)})):await f(e)}};return(null==r?void 0:r.props)&&P.setProps(r.props),{register:(e,a)=>{d.value=e,m.value=a},elTableRef:m,tableObject:u,methods:P}};export{u};
